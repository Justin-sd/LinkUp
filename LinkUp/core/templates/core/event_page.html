{% extends 'base.html' %}
{% block title %}LinkUp {% endblock title %} //modifying the title

{% block content %}
    <script type='text/javascript'>
        function sendEmail() {
            let invitee_email = $("#invitee_email").val();
            let data = {"invitee_email": invitee_email, "event_id": {{event.event_id}}};

            const token = "{{csrf_token}}";
            $.ajax({
                headers: {"X-CSRFToken": token},
                type: "POST",
                url: "/send_email/",
                data: data,
            }).done(function (res) {
                // clear text
                $("#invitee_email").val('');
            });
        }
    </script>

    <section class="section">
       <div class="section">
    <div class="columns">
        <aside class="column is-2">
            <nav class="menu">
               <p class="menu-label is-size-5">
                  General
               </p>
               <hr/>
               <ul class="menu-list">
                  <li>
                     <a class="is-size-4" href="/my_events">
                     My Events
                     </a>
                     <ul>
                        {% for event in user_events %}
                        <li>
                            {% if event.event_id == event_id %}
                                <a class="is-active is-size-4" href="/event_page/{{ event.event_id }}">{{ event.title }}</a>
                            {% else %}
                                <a class="is-size-4" href="/event_page/{{ event.event_id }}">{{ event.title }}</a>
                            {% endif %}
                        </li>
                        {% endfor %}
                     </ul>
                     <a id="createEvent" class="button is-size-4" > + Create An Event</a>
                      {% include 'core/create_event_modal.html' %}
                  </li>
               </ul>
               <p class="menu-label is-size-5">
                  Availability
               </p>
               <ul class="menu-list">
                  <li>
                     <a class="is-size-4" href="/my_availability">
                     Adjust Your Availability
                     </a>
                      <ul>
                        <li>
                            <a href="google_calendar/" class="is-size-4">
                                Import From Google Calendar
                            </a>
                        </li>
                   </ul>
                  </li>
               </ul>

                {% if admin %}
                <p class="menu-label is-size-5">
                  Admin Controls
                </p>
                    <ul class="menu-list">
                  <li>
                     <a class="is-size-4" id="invitebutton">
                        Invite Guest
                     </a>
                  </li>
                    <li>
                       <a class="is-size-4" id="addadmin">
                        Add An Admin
                     </a>
                   </li>
               </ul>
    {% endif %}
            </nav>
         </aside>
        <div class="column">
            <div class="box">
                {% if admin %}
                 <h1 class="title" contenteditable="true" id="EventTitle" >{{event.title}}</h1>
                {% else %}
                    <h1 class="title"  >{{event.title}}</h1>
                {% endif %}
                <hr/>
                <div class="level">
                    <div class="level-left">
                        <a class="button is-info">Set Availability</a>
                    </div>
                </div>
                <div class="panel">
                    <p class="panel-heading has-background-info">
                        My Availability for {{event.title}}
                    </p>
                    {% include "core/availability_calendar.html" %}
                </div>
            </div>
        </div>
    </div>
       </div>
    </section>
    <section class="section">
        <div class="columns is-multiline">
            <div class="column">
                <div class="panel">
                    <p class="panel-heading has-background-info">
                        Event Description
                    </p>
                    {% if admin %}
                    <div class="panel-block" id="EventDescription" contenteditable="true">
                        {{ event.description }}
                    </div>
                    {% else %}
                        <div class="panel-block" >
                        {{ event.description }}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="columns">
            <div class="column">
                <div class="panel">
                    <p class="panel-heading has-background-info">
                        <a class="button is-pulled-right is-small">+ Add Members</a> <!--TODO-->
                        Attendees
                    </p>
                    {% for members in event.members.all %}
                    <div class="panel-block">
                        {{ members }}
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="columns is-multiline">
                    <!--TODO-->
            <div class="column is-6">
                <div class="panel">
                    <p class="panel-heading has-background-info">
                        Available
                    </p>
                    <div class="panel-block">
                        Optimal starting times from best to worst:<br />
                        {% for a,b in time_list %}
                            {{a}} with members {{b}}<br />
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="column is-6">
                <div class="panel">
                    <p class="panel-heading has-background-info">
                        Not Available
                    </p>
                    <div class="panel-block">
                        Unsure how to handle
                    </div>
                </div>
            </div>
        </div>
    </section>

      <!-- The Modal Add an Admin -->
      <div id="AdminModal" class="modal">
         <!-- Modal content -->
         <div class="modal-content" id="AdminContent">
            <div class="modal-header" id="AdminHeader" >
               <span class="close"></span>
               <center>
                  <h1  style="font-size: x-large">Add Administrator for the Event</h1>
               </center>
               <br>
            </div>
            <div class="modal-body" id="AdminBody">

            <div class="row">
            <div class="col-sm-6">
                <br>
       <p>Choose Admins from the following list:</p>
            </div>
            <div class="col-sm-6">

                    {% for members in event.members.all %}
                    <div class="panel-block">
                        <label class="checkbox">
                        <input type="checkbox">
                               {{ members }}
                            </label>
                     </div>
                    {% endfor %}
            </div>
         </div>   <! -- end of row -->
            <div class="row">
                <p>--------------------------------------------------- or -----------------------------------------------------------</p>
                <center>
                             <a class="button is-info is-size-6-touch" style="background-color: orange">Add</a>
                </center>
            </div> <! -- End of second row -->

            </div> <! --- End of modal content-->

            <div class="modal-footer" id="AdminFooter">
               <h3></h3>
            </div>
         </div>
      </div>
      <!-- End modal -->

 <!-- Invite Guest Modal -->
      <div id="InviteModal" class="modal" >
         <!-- Modal content -->
         <div class="modal-content" id="InviteContent">
            <div class="modal-header" id="InviteHeader" >
               <span class="close"></span>
               <center>
                  <h1  style="font-size: x-large">Invite Guests</h1>
               </center>
               <br>
            </div>

            <div class="modal-body" id="InviteBody">
               <center>
                   <h3>Guest Email:</h3>
                    <form method="" id="container" onsubmit="sendEmail()">
                        <input id="invitee_email" type="email"/>
                        <input type="submit" value="Send Email"/>
                    </form>
               </center>
            </div>
            <div class="modal-footer" id="InviteFooter">
               <h3></h3>
            </div>
         </div>
      </div>
      <!-- End modal -->


{% endblock content %}